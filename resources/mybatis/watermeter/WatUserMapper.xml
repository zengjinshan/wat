<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WatUserMapper">

    <select id="findPhoneSsm" parameterType="phoneSsm" resultType="phoneSsm">
        SELECT * FROM T_W_PHONE_SSM WHERE 1=1
        <if test="phone !=null and phone!=''">
            AND PHONE=#{phone}
        </if>
        <if test="validMsg!=null and validMsg!=''">
            AND VALID_MSG=#{validMsg}
        </if>
         <if test="validInd!=null and validInd!=''">
             AND VALID_IND=#{validInd}
         </if>
        ORDER BY CREATE_DATE DESC limit 1
    </select>

    <select id="generatWatNo" resultType="java.lang.String">
        select LPAD(_nextval('watNo'),10,'0')
    </select>

    <update id="updateUser" parameterType="watUser">
        update T_W_USER SET
        <if test="nickName!=null and nickName!=''">
        NICK_NAME=#{nickName}
        </if>
        <if test="address!=null and address!=''">
            ,ADDRESS=#{address}
        </if>
        <if test="email!=null and email!=''">
            ,EMAIL=#{email}
        </if>
        <if test="area!=null and area!=''">
            ,AREA=#{area}
        </if>
        <if test="sex!=null and sex!=''">
            ,SEX=#{sex}
        </if>
        <if test="tag!=null and tag!=''">
            TAG=#{tag}
        </if>
        WHERE id=#{id}
    </update>

    <update id="updateUserByPhone" parameterType="watUser">
        UPDATE T_W_USER SET PASSWORD=#{password}
        WHERE PHONE=#{phone}
    </update>


    </mapper>